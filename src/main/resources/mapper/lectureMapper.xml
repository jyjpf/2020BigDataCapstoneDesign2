<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dictation.mapper.LectureMapper"> 
	
	<select id="get" parameterType="Map" resultType="LectureVO">

		select
			year,
			term,
			lecture_no,
			lecture_nm,
			school_cd,
			grade,
			ban,
			enroll_st_dt,
			enroll_ed_dt,
			max_cnt,
			teacher_id,
			teacher_nm
		from
			lecture
		where 1=1
			and lecture_no = #{lecture_no}
			and school_cd = #{school_cd}

	</select>

	<select id="getList" parameterType="Map" resultType="LectureVO">

		select
			year,
			term,
			lecture_no,
			lecture_nm,
			school_cd,
			grade,
			ban,
			enroll_st_dt,
		    enroll_ed_dt,
			max_cnt,
			teacher_id,
			teacher_nm,
			input_id,
			input_date,
			update_id,
			update_date
		from
			lecture
		where 1=1
			and school_cd = #{school_cd}
			and lecture_type_cd != '005003'
		<if test="teacher_id != null">
			and teacher_id = #{teacher_id}
		</if>

	</select>

	<insert id="insert" parameterType="LectureVO">

		insert into lecture (
			year,
			term,
			lecture_no,
			lecture_nm,
			school_cd,
			grade,
			ban,
			enroll_st_dt,
			enroll_ed_dt,
			max_cnt,
			teacher_id,
			teacher_nm,
			input_id,
			input_date,
			update_id,
			update_date
		) values (
			'2020',
			'1',
			(
			select
				coalesce(max(lecture_no) + 1, 1)
			from
				lecture
			),
			#{lecture_nm},
			#{school_cd},
			#{grade},
			#{ban},
			#{enroll_st_dt},
			#{enroll_ed_dt},
			#{max_cnt},
			#{teacher_id},
			#{teacher_nm},
			#{input_id},
			now(),
			#{input_id},
			now()
		)

	</insert>

	<update id="update" parameterType="LectureVO">

		update
		    lecture
		set
			year = '2020',
			term = '1',
			lecture_nm = #{lecture_nm},
			school_cd = #{school_cd},
			grade = #{grade},
			ban = #{ban},
			enroll_st_dt = #{enroll_st_dt},
			enroll_ed_dt = #{enroll_ed_dt},
			max_cnt = #{max_cnt},
			teacher_id = #{teacher_id},
			teacher_nm = #{teacher_nm},
			update_id = #{teacher_id},
			update_date = now()
		where
			lecture_no = #{lecture_no}

	</update>
 
	<delete id="delete" parameterType="String">

		delete from
			lecture
		where 1=1
			and lecture_no = #{lecture_no}

	</delete>

</mapper>

